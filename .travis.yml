dist: xenial
sudo: false

language: c
compiler: clang
cache: ccache

env:
  global:
    - CC=clang
    - CXX=clang++
    - CFLAGS=-fsanitize=fuzzer,address
    - CXXFLAGS=-fsanitize=fuzzer,address
    - LIB_FUZZING_ENGINE=-fsanitize=fuzzer
  matrix:
    - FUZZER=7zcrc_fuzzer
    - FUZZER=bra_arm_fuzzer
    - FUZZER=bra_armt_fuzzer
    - FUZZER=bra_ia64_fuzzer
    - FUZZER=bra_ppc_fuzzer
    - FUZZER=bra_sparc_fuzzer
    - FUZZER=bra_x86_fuzzer
    - FUZZER=delta_fuzzer
    - FUZZER=lzma2dec_fuzzer
    - FUZZER=lzma2enc_fuzzer
    - FUZZER=lzmadec_fuzzer
    - FUZZER=lzmaenc_fuzzer
    - FUZZER=xzcrc64_fuzzer

script:
  - make
  - |
    [ ! -d "corpus/$FUZZER" ] || ./$FUZZER corpus/$FUZZER/*
  - ./$FUZZER -max_total_time=10
